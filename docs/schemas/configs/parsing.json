{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "service_name": "parsing",
  "schema_version": "1.0.0",
  "min_service_version": "0.1.0",
  "metadata": {
    "description": "Parsing service configuration schema",
    "version": "1.0.0"
  },
  "fields": {
    "message_bus_type": {
      "type": "string",
      "source": "env",
      "env_var": "MESSAGE_BUS_TYPE",
      "required": true,
      "description": "Message bus type"
    },
    "message_bus_host": {
      "type": "string",
      "source": "env",
      "env_var": "MESSAGE_BUS_HOST",
      "default": "messagebus",
      "description": "Message bus hostname"
    },
    "message_bus_port": {
      "type": "int",
      "source": "env",
      "env_var": "MESSAGE_BUS_PORT",
      "default": 5672,
      "description": "Message bus port"
    },
    "message_bus_user": {
      "type": "string",
      "source": "secret",
      "secret_name": "message_bus_user",
      "required": false,
      "description": "Message bus username (secret)"
    },
    "message_bus_password": {
      "type": "string",
      "source": "secret",
      "secret_name": "message_bus_password",
      "required": false,
      "description": "Message bus password (secret)"
    },
    "doc_store_type": {
      "type": "string",
      "source": "env",
      "env_var": "DOCUMENT_STORE_TYPE",
      "required": true,
      "description": "Document store type"
    },
    "doc_store_host": {
      "type": "string",
      "source": "env",
      "env_var": "DOCUMENT_DATABASE_HOST",
      "default": "documentdb",
      "description": "Document store hostname"
    },
    "doc_store_port": {
      "type": "int",
      "source": "env",
      "env_var": "DOCUMENT_DATABASE_PORT",
      "default": 27017,
      "description": "Document store port"
    },
    "doc_store_name": {
      "type": "string",
      "source": "env",
      "env_var": "DOCUMENT_DATABASE_NAME",
      "default": "copilot",
      "description": "Document store database name"
    },
    "doc_store_user": {
      "type": "string",
      "source": "secret",
      "secret_name": "document_database_user",
      "required": false,
      "description": "Document store username (secret)"
    },
    "doc_store_password": {
      "type": "string",
      "source": "secret",
      "secret_name": "document_database_password",
      "required": false,
      "description": "Document store password (secret)"
    },
    "archive_store_type": {
      "type": "string",
      "source": "env",
      "env_var": "ARCHIVE_STORE_TYPE",
      "required": true,
      "description": "Archive store backend (local, azure_blob)"
    },
    "archive_store_path": {
      "type": "string",
      "source": "env",
      "env_var": "ARCHIVE_STORE_PATH",
      "default": "/data/raw_archives",
      "description": "Base path for local archive storage"
    },
    "archive_store_connection_string": {
      "type": "string",
      "source": "env",
      "env_var": "ARCHIVE_STORE_CONNECTION_STRING",
      "default": "",
      "description": "Connection string for archive store (azure_blob)"
    },
    "archive_store_account_name": {
      "type": "string",
      "source": "env",
      "env_var": "ARCHIVE_STORE_ACCOUNT_NAME",
      "default": "",
      "description": "Storage account name for managed identity authentication (azure_blob)"
    },
    "archive_store_container": {
      "type": "string",
      "source": "env",
      "env_var": "ARCHIVE_STORE_CONTAINER",
      "default": "raw-archives",
      "description": "Container name for archive store (azure_blob)"
    },
    "metrics_type": {
      "type": "string",
      "source": "env",
      "env_var": "METRICS_BACKEND",
      "required": true,
      "description": "Metrics backend type (prometheus, pushgateway, azure_monitor, noop)"
    },
    "error_reporter_type": {
      "type": "string",
      "source": "env",
      "env_var": "ERROR_REPORTER_TYPE",
      "required": true,
      "description": "Error reporter type"
    },
    "log_level": {
      "type": "string",
      "source": "env",
      "env_var": "LOG_LEVEL",
      "default": "INFO",
      "description": "Logging level"
    },
    "http_port": {
      "type": "int",
      "source": "env",
      "env_var": "HTTP_PORT",
      "default": 8000,
      "description": "HTTP server port"
    },
    "max_retries": {
      "type": "int",
      "source": "env",
      "env_var": "RETRY_MAX_ATTEMPTS",
      "default": 3,
      "description": "Maximum retry attempts"
    },
    "retry_delay": {
      "type": "int",
      "source": "env",
      "env_var": "RETRY_DELAY_SECONDS",
      "default": 5,
      "description": "Retry delay in seconds"
    },
    "jwt_auth_enabled": {
      "type": "bool",
      "source": "env",
      "env_var": "JWT_AUTH_ENABLED",
      "default": true,
      "description": "Enable JWT authentication middleware"
    }
  }
}
